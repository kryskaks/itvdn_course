1. Добавить проверку ответа апи - статус 200, а также обернуть в try-except
2. подумать, как можно убрать повторяющийся код инициализации логгера